+++
id = 33
name = "Request methods with ip and user agent"
description = "This query grabs all requests by method, excluding common GETs and POSTs. Returns ip address and user agents, with count for each, for determining whether any are testing vulnerabilities."
keywords = ["iisw3c"]
statement-parameters = "-i:w3c -o:w3c"
statement-select = "cs-method, c-ip, cs(User-Agent), COUNT(*) AS [Requests]"
statement-using = ""
statement-into = "requestMethods.log"
statement-from = "u_ex1010*.log"
statement-where = "cs-method NOT IN ('GET';'POST')"
statement-groupby = "cs-method, c-ip, cs(User-Agent)"
statement-having = ""
statement-orderby = "cs-method, Requests"
notes = "If POSTs aren't used on your site, you may want to remove that exclusion."
+++

