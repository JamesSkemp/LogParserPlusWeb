+++
id = 24
name = "Query parameter hacking attempt - http://"
description = "Returns a listing of IP addresses that may be making a hacking attempt by passing a site address."
keywords = ["iisw3c"]
statement-parameters = "-rtp:-1 -o:w3c"
statement-select = "c-ip, COUNT(*) AS [Requests]"
statement-using = ""
statement-into = "QueryParams-1c.log"
statement-from = "ex0910*.log"
statement-where = "cs-uri-query IS NOT null and STRCNT(TO_LOWERCASE(cs-uri-query), 'http://') > 0"
statement-groupby = "c-ip"
statement-having = ""
statement-orderby = "[Requests] DESC"
notes = "This query will only work if you are not expecting http:// to be present in a query parameter. Run another query against the logs to determine what files were requested by questionable IP addresses."
+++

